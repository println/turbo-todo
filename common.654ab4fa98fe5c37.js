"use strict";(self.webpackChunkturbo_todo=self.webpackChunkturbo_todo||[]).push([[592],{4244:(y,_,o)=>{function n(s=new Date){return{day:s.getDate(),month:s.getMonth()+1,year:s.getFullYear()}}function a(s,t=n()){return t.year>s.year||t.month>s.month||t.day>s.day}o.d(_,{RR:()=>a,lJ:()=>n})},6833:(y,_,o)=>{o.d(_,{Z:()=>s,q:()=>t});var n=o(5890),a=o(1331),r=o(3994);const e=(0,a.MT)({name:"history"},(0,n.h4)());(0,r.xi)(e,{key:"history-data",storage:r.n4});var i=o(1571);class s{constructor(){this.historyEntries$=e.pipe((0,n.WK)())}}s.\u0275fac=function(c){return new(c||s)},s.\u0275prov=i.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"});class t{archive(c){let l={id:Math.random().toString(),date:c.date,tasks:c.tasks.map(h=>h.id)};e.update((0,n.dP)(l))}clear(){e.update((0,n.M3)())}}t.\u0275fac=function(c){return new(c||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})},2661:(y,_,o)=>{o.d(_,{F:()=>r});var n=o(1342),a=o(1571);class r{constructor(){this.snapshot$=n.G.pipe()}}r.\u0275fac=function(d){return new(d||r)},r.\u0275prov=a.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})},2065:(y,_,o)=>{o.d(_,{Z:()=>i});var n=o(4244),a=o(1342),r=o(1571),e=o(6833),d=o(3440);class i{constructor(t,u){this.historyService=t,this.todoRepository=u,u.activeTasks$.subscribe(c=>{this.updateSnapshot(c)})}renewStore(){let t={...a.G.getValue()};this.historyService.archive(t),a.G.update(u=>({date:(0,n.lJ)(),tasks:[]})),this.todoRepository.releaseAllTasks()}updateSnapshot(t){a.G.update(u=>({...u,tasks:t}))}checkConsistency(){let t=a.G.getValue().date;(0,n.RR)(t)&&this.renewStore()}}i.\u0275fac=function(t){return new(t||i)(r.LFG(e.q),r.LFG(d.e))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})},1342:(y,_,o)=>{o.d(_,{G:()=>e});var n=o(1331),a=o(3994),r=o(4244);const e=(0,n.MT)({name:"snapshot"},(0,n.vl)({date:(0,r.lJ)(),tasks:[]}));(0,a.xi)(e,{key:"snapshot-data",storage:a.n4})},9070:(y,_,o)=>{o.d(_,{e:()=>n.e});var n=o(3440)}}]);